<!DOCTYPE html>

{% load staticfiles %}
{% url 'auth_logout' as logout_url%}
{% load bootstrap %}


<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Olympyo</title>
    
    <script src="http://code.jquery.com/jquery-2.1.0.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js" type="text/javascript"></script>
    <script src="{{STATIC_URL}}js/jquery.slimscroll.min.js" type="text/javascript"></script>
    <script src="{{STATIC_URL}}js/bootstrap.min.js"></script>
    <script src="{{STATIC_URL}}js/retina-1.1.0.min.js"></script>
    <script src="{{STATIC_URL}}js/defaults.js"></script>
    
    <link rel="stylesheet" href="{{STATIC_URL}}css/bootstrap.min.css">
    <link rel="stylesheet" href="{{STATIC_URL}}game/css/less.css">
    <link rel="stylesheet" href="{{STATIC_URL}}game/css/game_objects.css">
    
</head>
<body>

    <header id="header" class="container">
        <h1 id="branding" class="row">Olympyo</h1>
    </header>
    <div class="alert alert-success text-center">

        Welcome to the test simulation! For a quick rundown on the rules of this game, click <a class="alert-link" rel="popover" data-container="body" data-toggle="popover" data-placement="bottom" data-html="true" data-content="You're playing the first game prototype! This farm village has farms, players who own them, and labourers who work them. You're the player indicated in the blue button at the top left of the screen, and your goal is to maximize leisure - indicated beside your player button. <br /><br />You earn one leisure for every turn you don't work. So you own a farm, and you can select it by selecting yourself, and then the farm that you own. You're able to work your farm and set a wage, or not work it and set two wages. When you don't work, you earn one leisure. <br /><br />But be careful: all players and labourers eat one wealth each turn, whether they work or not. And farms are much more productive if two people work them instead of one. Labourers take the highest wages offered in the farm village. Pay too little, and you won't attract labour and make much; but pay too much, and your profits will suffer. <br /><br />And that's basically it! Have fun!">here</a>
    </div>
    <nav id="gui"></nav>
    <div class="container">
    <div id="static-bar" class="row panel panel-default">
        <div class="panel-body col-sm-5">
        <div id="hud-player-object" class="">
            <a class="btn btn-primary" href="?game_object_id={{ user_instance_object.id }}">
            {{ user_instance_object.game_object|capfirst }}
            </a>
             &nbsp;
            {% for attribute in player_stats %}
            {{ attribute.attribute|capfirst }} <span class="badge">{{ attribute.value|floatformat:2 }} </span> &nbsp; 
            {% endfor %}
        </div>
        </div>
        <div id="hud-timer" class="panel-body col-sm-2">
            <div class="progress text-center">
                <div class="progress-bar" role="progressbar" aria-valuenow="1603" aria-valuemin="0" aria-valuemax="3600" style="width: 60%;">
                    Turn timer
                </div>
            </div>
        </div>
        <div id="hud-turn" class="panel-body col-sm-5 text-right">
            <a id="turn-number" class="btn btn-primary" rel="popover" data-container="body" data-toggle="popover" data-placement="bottom" data-content="This game has 20 turns.">
                Turn <span class="badge">{{ turn }}</span>
            </a>
        </div>
        <!--<div id="hud-action-log" class="col-sm-1">
            <b>Actions</b>
        </div>-->
        
        </div>
    </div>
    </div>
    <div id="" class="container">
        <div class="row">
        <div class="col-sm-2">
            <div class="list-group">
                <a class="list-group-item active btn btn-default" rel="popover" data-container="body" data-toggle="popover" data-placement="bottom" data-content="Agents take actions each turn. Players are human &#40;like you!&#41; and other agents are AI who respond to your actions.">
                Agents
                </a>
                {% for auto_object in autonomous_objects %}
                <a class="list-group-item" href="?game_object_id={{ auto_object.id }}" id="{{ auto_object.id }}">
                    {{ auto_object.game_object|capfirst }} 
                </a>
            {% endfor %}
            </div>
        </div>
        <div class="col-sm-8">
            <div id="hud-object-stats" class="row">
                <div class="col-sm-3">
                    <a class="list-group-item active btn btn-default" rel="popover" data-container="body" data-toggle="popover" data-placement="bottom" data-content="Available actions and attributes relate to the selected object.">
                    Selected object
                    </a>
                    <div class="text-center">{{ game_object.game_object|capfirst }}</div>
                    {% if game_object %}
                    <div id='selected-object' class='text-center img-circle {{ game_object.game_object.game_object.arch_game_object }}-lg'>
                    </div>
                    {% else %}
                    <ul class="list-group text-center">
                        <li class="list-group-item">None</li>
                    </ul>
                    {% endif %}
                    <h5 class="text-center">Owns</h5>
                    <div class="list-group text-center">   
                        {% for relationship in game_object.relationship_subjects.all %}
                        <a class="list-group-item" href="?game_object_id={{ relationship.object_game_instance_object.id }}">{{ relationship.object_game_instance_object.game_object|capfirst }}</a>
                        {% empty %}
                        <div class="list-group-item">Nothing</div>
                        {% endfor %}
                    </div>
                </div>
                <div class="col-sm-5">
                    <a class="list-group-item active btn btn-default" rel="popover" data-container="body" data-toggle="popover" data-placement="bottom" data-content="Available actions define what you can do with the selected object.">
                    Available actions
                    </a>
                    {% if game_object.game_object.game_object in player_permitted_action_objects and user_instance_object in game_object_owner_set %}
                    <form class='form-horizontal' role='form' method='post' action=''>{% csrf_token %}
                        <fieldset {% if user_already_played %} disabled {% endif %}>
                        {{ action_form|bootstrap_horizontal:'col-lg-6 col-sm-6' }}
                        <button type="submit" class="btn btn-default col-sm-12">Commit</button>
                        </fieldset>
                    </form>
                    {% else %}
                    <ul class="list-group">
                        <li class="list-group-item text-center">None</li>
                    </ul>
                    {% endif %}
                </div>
                <div class="col-sm-4">
                    <a class="list-group-item active btn btn-default" rel="popover" data-container="body" data-toggle="popover" data-placement="bottom" data-content="Attributes define the selected object. Some of them may change each turn, as players' actions affect the game.">
                    Attributes
                    </a>
                    <ul class="list-group">
                        {% for attribute in game_object.attribute_values.all %}
                        <li class="list-group-item">{{ attribute.attribute|capfirst }}<span class="badge">{{ attribute.value|floatformat:2 }}</span></li>
                        {% empty %}
                        <li class="list-group-item text-center">None</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
        <div class="col-sm-2">
            <a class="list-group-item active btn btn-default" rel="popover" data-container="body" data-toggle="popover" data-placement="bottom" data-content="Farms sit passively until you act on them. In this game, you can hire people to work farms that you own, and you can work one yourself.">
                Farms
            </a>
            {% for display_object in display_objects %}
            <a href="?game_object_id={{ display_object.id }}" id="{{ display_object.id }}" class="{% if display_object.id == game_object.id %}bg-primary{% endif %} col-sm-3 layout-object img-circle {{ display_object.game_object.game_object.arch_game_object }}-sm"></a>
            {% endfor %}
            
        </div>
        </div>
        {% if user_already_played %}
        <div class="alert alert-success text-center">
            You have committed actions this turn!
        </div>
        {% elif action_form.errors %}
        <div class="alert alert-danger alert-dismissable text-center">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">
                &times;
            </button>
            Oops - you committed invalid actions...
        </div>
        {% else  %}
        <div class="alert alert-info text-center">
            Go ahead and explore, then commit your actions on the objects you own.
        </div>
        {% endif %}
    </div>
    

    <footer id="footer">
        <div id="hud" class="container">
            
        </div>
        <!-- <a href="{{ logout_url }}">Logout</a> -->
    </footer>
    
    <!--
    <script type="text/javascript">
        $(function(){
            $('#content').slimScroll({
                height: '250px'
            });
        });
    </script>
    -->
    <script type="text/javascript">
        $(function () {
            $("[rel='tooltip']").tooltip();
        });
    </script>
    <script>
        $(function () {
            $("[rel='popover']").popover();
        });
    </script>
    
    
</body>
</html>